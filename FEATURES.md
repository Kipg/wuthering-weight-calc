# 功能更新说明

## 已完成的功能

### 1. ✅ 背景和UI改进
- 背景改为白色偏蓝的渐变效果 (`from-blue-50 via-white to-blue-100`)
- 整体UI采用毛玻璃效果 (`backdrop-blur-sm`)
- 卡片使用白色半透明背景和蓝色边框

### 2. ✅ 角色系统
- **角色选择弹窗**：点击"选择角色"按钮打开弹窗
  - 搜索功能：可以搜索角色名称
  - 角色卡片展示：显示角色图片（需要放置在 `public/characters/` 目录）
  - 图片命名：`T_Luckdraw_katixiya_UI.png`
- **等级选择**：下拉菜单选择角色等级
- **角色图片显示**：角色信息卡片显示角色头像

### 3. ✅ 武器系统
- **武器选择弹窗**：点击"选择武器"按钮打开弹窗
  - 搜索功能：可以搜索武器名称
  - 武器卡片展示：显示武器图片（需要放置在 `public/weapons/` 目录）
  - 图片命名：`TL_buqumingdingzhiguan_UI.png`
- **等级选择**：下拉菜单选择武器等级
- **谐振等级选择**：下拉菜单选择谐振等级（1-5级）
- **武器图片显示**：武器信息卡片显示武器图标

### 4. ✅ 公式说明动画
- 点击"鸣潮文字公式"标题展开/收起
- 平滑的动画过渡效果：
  - 高度动画 (`max-height` transition)
  - 透明度动画 (`opacity` transition)
  - 箭头旋转动画 (`transform: rotate`)

### 5. ✅ 声骸系统（准备就绪）
- 创建了 `public/echoes/` 文件夹用于存放声骸图片
- 声骸数据已拆分到独立文件：
  - `data/echoes/xinjilemu.ts`
  - `data/echoes/fuludelis.ts`
  - `data/echoes/kaierpi.ts`
  - `data/echoes/kuxinzhedezuosong.ts`
  - `data/echoes/xiaoyilong_rerong.ts`
  - `data/echoes/xiaoyilong_yanshe.ts`
- 图片命名规则：`TM_xinjilemu_UI.png`

### 6. ✅ 技能流程配置
- **技能选择**：点击技能按钮添加到流程中
- **释放次数设置**：每个技能可设置释放次数
- **暴击模式选择**：每个技能可选择"期望"、"暴击"或"不暴击"
- **流程管理**：可以删除单个技能或清空整个流程
- **可重复添加**：同一技能可以多次添加到流程中

### 7. ✅ 伤害分布可视化
- **饼图显示**：使用自定义SVG饼图组件（无需外部库）
- **双模式切换**：
  - 技能类型占比（常态攻击、共鸣技能、共鸣回路、共鸣解放、变奏技能）
  - 伤害类型占比（普攻、重击、共鸣技能、共鸣解放）
- **图例显示**：显示每个类型的名称、颜色和百分比
- **总伤害显示**：显示所有技能的总伤害

### 8. ✅ 计算流程详情
- **技能列表**：展示每个技能的：
  - 释放次数
  - 暴击模式
  - 单次伤害
  - 该技能造成的总伤害
- **详细计算过程**：点击"查看"按钮展开，显示：
  - 基础乘区
  - 技能倍率
  - 倍率提升
  - 暴击倍率
  - 伤害加深
  - 伤害加成
  - 防御乘区
  - 抗性乘区
  - 次数乘区
  - 完整的计算公式和结果

## 文件结构

```
wuthering-waves-calc/
├── app/
│   ├── page.tsx (重写，包含所有新功能)
│   └── components/
│       └── PieChart.tsx (新增，饼图组件)
├── data/
│   ├── echoes.ts (保留为兼容层)
│   └── echoes/ (新增文件夹)
│       ├── index.ts
│       ├── xinjilemu.ts
│       ├── fuludelis.ts
│       ├── kaierpi.ts
│       ├── kuxinzhedezuosong.ts
│       ├── xiaoyilong_rerong.ts
│       └── xiaoyilong_yanshe.ts
└── public/
    ├── characters/ (已存在，需放置角色图片)
    │   └── T_Luckdraw_katixiya_UI.png
    ├── weapons/ (已存在，需放置武器图片)
    │   └── TL_buqumingdingzhiguan_UI.png
    └── echoes/ (新创建，需放置声骸图片)
        ├── TM_xinjilemu_UI.png
        ├── TM_fuludelis_UI.png
        ├── TM_kaierpi_UI.png
        ├── TM_kuxinzhedezuosong_UI.png
        ├── TM_xiaoyilong_rerong_UI.png
        └── TM_xiaoyilong_yanshe_UI.png
```

## 使用说明

1. **选择角色**：点击角色信息卡片右上角的"选择角色"按钮
2. **选择武器**：点击武器信息卡片右上角的"选择武器"按钮
3. **调整等级**：使用下拉菜单调整角色等级和武器等级/谐振等级
4. **配置技能流程**：
   - 点击"技能流程配置"区域的"展开"按钮
   - 点击技能按钮添加到流程中
   - 设置每个技能的释放次数和暴击模式
5. **查看伤害分析**：
   - 配置技能流程后自动生成伤害分布饼图
   - 切换"技能类型"和"伤害类型"查看不同维度的分析
   - 点击技能详情中的"查看"按钮查看详细计算过程

## 注意事项

- 图片文件需要手动放置到对应的 `public/` 子目录中
- 如果图片不存在，会显示渐变色背景作为占位符
- 所有图片名称必须严格遵循命名规则
- 当前声骸选择功能未实现UI（数据结构已准备好）

## 下一步可实现的功能

- [ ] 完整的声骸选择UI（5个声骸槽位）
- [ ] 声骸主属性和副词条配置
- [ ] 声骸套装选择
- [ ] 角色固有技能开关
- [ ] 武器技能效果开关
- [ ] 数据导入/导出功能
- [ ] 伤害对比模式
- [ ] 副词条权重分析
